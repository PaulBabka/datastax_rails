<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>Class: DatastaxRails::Relation</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/datastax_rails/relation.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Object
  
</nav>

    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="SearchMethods.html">DatastaxRails::SearchMethods</a>
  
  
  
    <li><a class="include" href="ModificationMethods.html">DatastaxRails::ModificationMethods</a>
  
  
  
    <li><a class="include" href="FinderMethods.html">DatastaxRails::FinderMethods</a>
  
  
  
    <li><a class="include" href="SpawnMethods.html">DatastaxRails::SpawnMethods</a>
  
  
  </ul>
</nav>

    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-i-3D-3D">#==</a>
    
    <li><a href="#method-i-all">#all</a>
    
    <li><a href="#method-i-any-3F">#any?</a>
    
    <li><a href="#method-i-count">#count</a>
    
    <li><a href="#method-i-default_scope">#default_scope</a>
    
    <li><a href="#method-i-empty-3F">#empty?</a>
    
    <li><a href="#method-i-exists-3F">#exists?</a>
    
    <li><a href="#method-i-inspect">#inspect</a>
    
    <li><a href="#method-i-many-3F">#many?</a>
    
    <li><a href="#method-i-method_missing">#method_missing</a>
    
    <li><a href="#method-i-new">#new</a>
    
    <li><a href="#method-i-reload">#reload</a>
    
    <li><a href="#method-i-reset">#reset</a>
    
    <li><a href="#method-i-results">#results</a>
    
    <li><a href="#method-i-size">#size</a>
    
    <li><a href="#method-i-sunspot_search">#sunspot_search</a>
    
    <li><a href="#method-i-to_a">#to_a</a>
    
    <li><a href="#method-i-total_pages">#total_pages</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../README_rdoc.html">README</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../DatastaxRails.html">SolandraObject</a>
  
    <li><a href="../DatastaxRails/AssociationTypeMismatch.html">SolandraObject::AssociationTypeMismatch</a>
  
    <li><a href="../DatastaxRails/Associations.html">SolandraObject::Associations</a>
  
    <li><a href="../DatastaxRails/Associations/Builder.html">SolandraObject::Associations::Builder</a>
  
    <li><a href="../DatastaxRails/Associations/Builder/BelongsTo.html">SolandraObject::Associations::Builder::BelongsTo</a>
  
    <li><a href="../DatastaxRails/Associations/ClassMethods.html">SolandraObject::Associations::ClassMethods</a>
  
    <li><a href="../DatastaxRails/AttributeMethods.html">SolandraObject::AttributeMethods</a>
  
    <li><a href="../DatastaxRails/AttributeMethods/ClassMethods.html">SolandraObject::AttributeMethods::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Base.html">SolandraObject::Base</a>
  
    <li><a href="../DatastaxRails/CassandraFinderMethods.html">SolandraObject::CassandraFinderMethods</a>
  
    <li><a href="../DatastaxRails/CassandraFinderMethods/ClassMethods.html">SolandraObject::CassandraFinderMethods::ClassMethods</a>
  
    <li><a href="../DatastaxRails/DeleteRestrictionError.html">SolandraObject::DeleteRestrictionError</a>
  
    <li><a href="../DatastaxRails/FinderMethods.html">SolandraObject::FinderMethods</a>
  
    <li><a href="../DatastaxRails/ModificationMethods.html">SolandraObject::ModificationMethods</a>
  
    <li><a href="../DatastaxRails/NamedScope.html">SolandraObject::NamedScope</a>
  
    <li><a href="../DatastaxRails/NamedScope/ClassMethods.html">SolandraObject::NamedScope::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Railtie.html">SolandraObject::Railtie</a>
  
    <li><a href="../DatastaxRails/RecordNotFound.html">SolandraObject::RecordNotFound</a>
  
    <li><a href="../DatastaxRails/RecordNotSaved.html">SolandraObject::RecordNotSaved</a>
  
    <li><a href="../DatastaxRails/Reflection.html">SolandraObject::Reflection</a>
  
    <li><a href="../DatastaxRails/Reflection/ClassMethods.html">SolandraObject::Reflection::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Reflection/MacroReflection.html">SolandraObject::Reflection::MacroReflection</a>
  
    <li><a href="../DatastaxRails/Relation.html">SolandraObject::Relation</a>
  
    <li><a href="../DatastaxRails/SearchMethods.html">SolandraObject::SearchMethods</a>
  
    <li><a href="../DatastaxRails/SolandraObjectError.html">SolandraObject::SolandraObjectError</a>
  
    <li><a href="../DatastaxRails/SpawnMethods.html">SolandraObject::SpawnMethods</a>
  
    <li><a href="../DatastaxRails/SunspotAdapters.html">SolandraObject::SunspotAdapters</a>
  
    <li><a href="../DatastaxRails/SunspotAdapters/SolandraObjectDataAccessor.html">SolandraObject::SunspotAdapters::SolandraObjectDataAccessor</a>
  
    <li><a href="../DatastaxRails/SunspotAdapters/SolandraObjectInstanceAdapter.html">SolandraObject::SunspotAdapters::SolandraObjectInstanceAdapter</a>
  
    <li><a href="../DatastaxRails/Validations.html">SolandraObject::Validations</a>
  
    <li><a href="../DatastaxRails/Validations/ClassMethods.html">SolandraObject::Validations::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Validations/UniquenessValidator.html">SolandraObject::Validations::UniquenessValidator</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class DatastaxRails::Relation</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="MULTI_VALUE_METHODS">MULTI_VALUE_METHODS
        
        <dd class="description">
        
      
        <dt id="SINGLE_VALUE_METHODS">SINGLE_VALUE_METHODS
        
        <dd class="description">
        
      
      </dl>
    </section>
    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-column_family" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">column_family</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-klass" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">klass</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-loaded" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">loaded</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-loaded-3F" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">loaded?</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-3D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">==</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns true if the two relations have the same query parameters</p>
          

          
          <div class="method-source-code" id="3D-3D-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Relation</span>
    <span class="ruby-identifier">other</span>.<span class="ruby-identifier">sunspot_search</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">to_params</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">sunspot_search</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">to_params</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
    <span class="ruby-identifier">to_a</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- 3D-3D-source -->
          
        </div>

        

        
      </div><!-- 3D-3D-method -->

    
      <div id="method-i-all" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">all</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Relation.html#method-i-to_a">to_a</a>
        </div>
        
      </div><!-- all-method -->

    
      <div id="method-i-any-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">any?</span><span
            class="method-args">() { |*block_args| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there are any results given the current criteria</p>
          

          
          <div class="method-source-code" id="any-3F-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">any?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">block_args</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>(*<span class="ruby-identifier">block_args</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-operator">!</span><span class="ruby-identifier">empty?</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- any-3F-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Relation.html#method-i-exists-3F">exists?</a>
        </div>
        

        
      </div><!-- any-3F-method -->

    
      <div id="method-i-count" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">count</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the total number of entries that match the given search. This means
the total number of matches regardless of page size. Compare with <a
href="Relation.html#method-i-size">#size</a>.</p>
          

          
          <div class="method-source-code" id="count-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">count</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">loaded?</span>
    <span class="ruby-ivar">@results</span>.<span class="ruby-identifier">total_entries</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">limit</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">total_entries</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- count-source -->
          
        </div>

        

        
      </div><!-- count-method -->

    
      <div id="method-i-default_scope" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_scope</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Gets a default scope with no conditions or search attributes set.</p>
          

          
          <div class="method-source-code" id="default_scope-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 69</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">default_scope</span>
  <span class="ruby-identifier">clone</span>.<span class="ruby-identifier">tap</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">SINGLE_VALUE_METHODS</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value">:&quot;@#{v}_value&quot;</span>, <span class="ruby-keyword">nil</span>)}
    <span class="ruby-constant">MULTI_VALUE_METHODS</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value">:&quot;@#{v}_values&quot;</span>, [])}
    <span class="ruby-identifier">apply_default_scope</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- default_scope-source -->
          
        </div>

        

        
      </div><!-- default_scope-method -->

    
      <div id="method-i-empty-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">empty?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there are no results given the current criteria</p>
          

          
          <div class="method-source-code" id="empty-3F-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">empty?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@results</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">loaded?</span>
  
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">count</span>
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:zero?</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">zero?</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- empty-3F-source -->
          
        </div>

        

        
      </div><!-- empty-3F-method -->

    
      <div id="method-i-exists-3F" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">exists?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Relation.html#method-i-any-3F">any?</a>
        </div>
        
      </div><!-- exists-3F-method -->

    
      <div id="method-i-inspect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inspect</span><span
            class="method-args">(just_me = false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="inspect-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>(<span class="ruby-identifier">just_me</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">just_me</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">super</span>() <span class="ruby-operator">:</span> <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- inspect-source -->
          
        </div>

        

        
      </div><!-- inspect-method -->

    
      <div id="method-i-many-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">many?</span><span
            class="method-args">() { |*block_args| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there are multiple results given the current criteria</p>
          

          
          <div class="method-source-code" id="many-3F-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 86</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">many?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">many?</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">block_args</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>(*<span class="ruby-identifier">block_args</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- many-3F-source -->
          
        </div>

        

        
      </div><!-- many-3F-method -->

    
      <div id="method-i-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Constructs a new instance of the class this relation points to</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 95</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-i-reload" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reload</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Reloads the results from Solr</p>
          

          
          <div class="method-source-code" id="reload-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 100</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reload</span>
  <span class="ruby-identifier">reset</span>
  <span class="ruby-identifier">to_a</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- reload-source -->
          
        </div>

        

        
      </div><!-- reload-method -->

    
      <div id="method-i-reset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reset</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Empties out the current results.  The next call to <a
href="Relation.html#method-i-to_a">#to_a</a> will re-run the query.</p>
          

          
          <div class="method-source-code" id="reset-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 108</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reset</span>
  <span class="ruby-ivar">@loaded</span> = <span class="ruby-ivar">@first</span> = <span class="ruby-ivar">@last</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@results</span> = []
<span class="ruby-keyword">end</span></pre>
          </div><!-- reset-source -->
          
        </div>

        

        
      </div><!-- reset-method -->

    
      <div id="method-i-results" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">results</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Relation.html#method-i-to_a">to_a</a>
        </div>
        
      </div><!-- results-method -->

    
      <div id="method-i-size" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">size</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the size of the total result set for the given criteria NOTE that
this takes pagination into account so will only return the number of
results in the current page.  <a
href="../DatastaxRails.html">SolandraObject</a> models can have a
<code>default_page_size</code> set which will cause them to be paginated
all the time. Compare with <a
href="Relation.html#method-i-count">#count</a></p>
          

          
          <div class="method-source-code" id="size-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 140</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">size</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@results</span>.<span class="ruby-identifier">size</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">loaded?</span>
  <span class="ruby-identifier">total_entries</span> = <span class="ruby-identifier">count</span>
  (<span class="ruby-identifier">per_page_value</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">total_entries</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">per_page_value</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">per_page_value</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">total_entries</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- size-source -->
          
        </div>

        

        
      </div><!-- size-method -->

    
      <div id="method-i-sunspot_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sunspot_search</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Creates and returns an actual sunspot search object based on the
information that is stored in this <code>Relation</code>.</p>
          

          
          <div class="method-source-code" id="sunspot_search-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 173</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sunspot_search</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@search</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@search</span>
  <span class="ruby-ivar">@search</span> = <span class="ruby-constant">Sunspot</span>.<span class="ruby-identifier">new_search</span>(<span class="ruby-ivar">@klass</span>)
  <span class="ruby-ivar">@where_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wv</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wv</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">with</span> <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@where_not_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wnv</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wnv</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">without</span> <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@greater_than_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">gtv</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">gtv</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">with</span>(<span class="ruby-identifier">k</span>).<span class="ruby-identifier">greater_than</span>(<span class="ruby-identifier">v</span>) }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@less_than_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ltv</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ltv</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">with</span>(<span class="ruby-identifier">k</span>).<span class="ruby-identifier">less_than</span>(<span class="ruby-identifier">v</span>) }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@order_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ov</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ov</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span>(<span class="ruby-ivar">@reverse_order_value</span>)
        <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">order_by</span> <span class="ruby-identifier">k</span>, (<span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-value">:asc</span> <span class="ruby-operator">?</span> <span class="ruby-value">:desc</span> <span class="ruby-operator">:</span> <span class="ruby-value">:asc</span>) }
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">order_by</span> <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> }
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@group_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">gv</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">group</span> <span class="ruby-identifier">gv</span> }
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@fulltext_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ftv</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> <span class="ruby-keyword">do</span> 
      <span class="ruby-identifier">fulltext</span> <span class="ruby-identifier">ftv</span>[<span class="ruby-value">:query</span>] <span class="ruby-keyword">do</span>
        <span class="ruby-keyword">if</span>(<span class="ruby-identifier">ftv</span>[<span class="ruby-value">:fields</span>])
          <span class="ruby-identifier">fields</span> <span class="ruby-identifier">ftv</span>[<span class="ruby-value">:fields</span>]
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span>(<span class="ruby-identifier">ftv</span>[<span class="ruby-value">:highlight</span>])
          <span class="ruby-identifier">highlight</span> <span class="ruby-identifier">ftv</span>[<span class="ruby-value">:fields</span>]
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-comment"># We have to put these in local variables because the block doesn't</span>
  <span class="ruby-comment"># get access to our instance variables</span>
  <span class="ruby-identifier">pv</span>, <span class="ruby-identifier">ppv</span>, <span class="ruby-identifier">ov</span> = <span class="ruby-ivar">@page_value</span>, <span class="ruby-ivar">@per_page_value</span>, <span class="ruby-ivar">@offset_value</span>
  <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> { <span class="ruby-identifier">paginate</span> <span class="ruby-value">:page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pv</span>, <span class="ruby-value">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ppv</span>, <span class="ruby-value">:offset</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ov</span> }
  
  <span class="ruby-identifier">qpv</span> = <span class="ruby-ivar">@query_parser_value</span>
  
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">qpv</span>
    <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">adjust_solr_params</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">params</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">params</span>[<span class="ruby-value">:defType</span>] = <span class="ruby-identifier">qpv</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">adjust_solr_params</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">params</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">params</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:defType</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@search_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sv</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@search</span>.<span class="ruby-identifier">build</span>(&amp;<span class="ruby-identifier">sv</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@search</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- sunspot_search-source -->
          
        </div>

        

        
      </div><!-- sunspot_search-method -->

    
      <div id="method-i-to_a" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_a</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Actually executes the query if not already executed. Returns a standard
array thus no more methods may be chained.</p>
          

          
          <div class="method-source-code" id="to_a-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 155</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_a</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@results</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">loaded?</span>
  <span class="ruby-ivar">@results</span> = <span class="ruby-identifier">sunspot_search</span>.<span class="ruby-identifier">execute</span>.<span class="ruby-identifier">results</span>
  <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@results</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_a-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Relation.html#method-i-all">all</a>, <a href="Relation.html#method-i-results">results</a>
        </div>
        

        
      </div><!-- to_a-method -->

    
      <div id="method-i-total_pages" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">total_pages</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the total number of pages required to display the results given the
current page size.  Used by will_paginate.</p>
          

          
          <div class="method-source-code" id="total_pages-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">total_pages</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">1</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@per_page_value</span>
  (<span class="ruby-identifier">count</span> <span class="ruby-operator">/</span> <span class="ruby-ivar">@per_page_value</span>.<span class="ruby-identifier">to_f</span>).<span class="ruby-identifier">ceil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- total_pages-source -->
          
        </div>

        

        
      </div><!-- total_pages-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Protected Instance Methods</h3>

    
      <div id="method-i-method_missing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">method_missing</span><span
            class="method-args">(method, *args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="method_missing-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation.rb, line 260</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">method_defined?</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">sunspot_search</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-identifier">sunspot_search</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">super</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- method_missing-source -->
          
        </div>

        

        
      </div><!-- method_missing-method -->

    
    </section><!-- protected-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.11.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

