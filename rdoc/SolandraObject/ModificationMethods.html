<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>Module: DatastaxRails::ModificationMethods</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/datastax_rails/relation/modification_methods.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-i-delete">#delete</a>
    
    <li><a href="#method-i-delete_all">#delete_all</a>
    
    <li><a href="#method-i-destroy">#destroy</a>
    
    <li><a href="#method-i-destroy_all">#destroy_all</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../README_rdoc.html">README</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../DatastaxRails.html">SolandraObject</a>
  
    <li><a href="../DatastaxRails/AssociationTypeMismatch.html">SolandraObject::AssociationTypeMismatch</a>
  
    <li><a href="../DatastaxRails/Associations.html">SolandraObject::Associations</a>
  
    <li><a href="../DatastaxRails/Associations/Builder.html">SolandraObject::Associations::Builder</a>
  
    <li><a href="../DatastaxRails/Associations/Builder/BelongsTo.html">SolandraObject::Associations::Builder::BelongsTo</a>
  
    <li><a href="../DatastaxRails/Associations/ClassMethods.html">SolandraObject::Associations::ClassMethods</a>
  
    <li><a href="../DatastaxRails/AttributeMethods.html">SolandraObject::AttributeMethods</a>
  
    <li><a href="../DatastaxRails/AttributeMethods/ClassMethods.html">SolandraObject::AttributeMethods::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Base.html">SolandraObject::Base</a>
  
    <li><a href="../DatastaxRails/CassandraFinderMethods.html">SolandraObject::CassandraFinderMethods</a>
  
    <li><a href="../DatastaxRails/CassandraFinderMethods/ClassMethods.html">SolandraObject::CassandraFinderMethods::ClassMethods</a>
  
    <li><a href="../DatastaxRails/DeleteRestrictionError.html">SolandraObject::DeleteRestrictionError</a>
  
    <li><a href="../DatastaxRails/FinderMethods.html">SolandraObject::FinderMethods</a>
  
    <li><a href="../DatastaxRails/ModificationMethods.html">SolandraObject::ModificationMethods</a>
  
    <li><a href="../DatastaxRails/NamedScope.html">SolandraObject::NamedScope</a>
  
    <li><a href="../DatastaxRails/NamedScope/ClassMethods.html">SolandraObject::NamedScope::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Railtie.html">SolandraObject::Railtie</a>
  
    <li><a href="../DatastaxRails/RecordNotFound.html">SolandraObject::RecordNotFound</a>
  
    <li><a href="../DatastaxRails/RecordNotSaved.html">SolandraObject::RecordNotSaved</a>
  
    <li><a href="../DatastaxRails/Reflection.html">SolandraObject::Reflection</a>
  
    <li><a href="../DatastaxRails/Reflection/ClassMethods.html">SolandraObject::Reflection::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Reflection/MacroReflection.html">SolandraObject::Reflection::MacroReflection</a>
  
    <li><a href="../DatastaxRails/Relation.html">SolandraObject::Relation</a>
  
    <li><a href="../DatastaxRails/SearchMethods.html">SolandraObject::SearchMethods</a>
  
    <li><a href="../DatastaxRails/SolandraObjectError.html">SolandraObject::SolandraObjectError</a>
  
    <li><a href="../DatastaxRails/SpawnMethods.html">SolandraObject::SpawnMethods</a>
  
    <li><a href="../DatastaxRails/SunspotAdapters.html">SolandraObject::SunspotAdapters</a>
  
    <li><a href="../DatastaxRails/SunspotAdapters/SolandraObjectDataAccessor.html">SolandraObject::SunspotAdapters::SolandraObjectDataAccessor</a>
  
    <li><a href="../DatastaxRails/SunspotAdapters/SolandraObjectInstanceAdapter.html">SolandraObject::SunspotAdapters::SolandraObjectInstanceAdapter</a>
  
    <li><a href="../DatastaxRails/Validations.html">SolandraObject::Validations</a>
  
    <li><a href="../DatastaxRails/Validations/ClassMethods.html">SolandraObject::Validations::ClassMethods</a>
  
    <li><a href="../DatastaxRails/Validations/UniquenessValidator.html">SolandraObject::Validations::UniquenessValidator</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module DatastaxRails::ModificationMethods</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-delete" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">delete</span><span
            class="method-args">(id)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>TODO: Find a way to delete from both without instantiating</p>
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="ModificationMethods.html#method-i-destroy">destroy</a>
        </div>
        
      </div><!-- delete-method -->

    
      <div id="method-i-delete_all" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">delete_all</span><span
            class="method-args">(conditions = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>TODO: Find a way to delete from both without instantiating</p>
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="ModificationMethods.html#method-i-destroy_all">destroy_all</a>
        </div>
        
      </div><!-- delete_all-method -->

    
      <div id="method-i-destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">destroy</span><span
            class="method-args">(id)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Destroy an object (or multiple objects) that has the given id, the object
is instantiated first, therefore all callbacks and filters are fired off
before the object is deleted. This method is in-efficient since it actually
has to instantiate the object just to delte it but allows cleanup methods
such as the ones that remove the object from SOLR to be run.</p>

<p>This essentially finds the object (or multiple objects) with the given id,
creates a new object from the attributes, and then calls destroy on it.</p>

<p>Note: this will only find objects that are matched by the current relation
even if the ID would otherwise be valid.</p>

<p><code>delete</code> is aliased to this because you can’t delete without
running the requisite callbacks. (at least not yet)</p>

<h4 id="method-i-destroy-label-Parameters">Parameters</h4>
<ul><li>
<p><code>id</code> - Can be either an Integer or an Array of Integers.</p>
</li></ul>

<h4 id="method-i-destroy-label-Examples">Examples</h4>

<p># Destroy a single object Todo.destroy(1)</p>

<p># Destroy multiple objects todos = [1,2,3] Todo.destroy(todos)</p>
          

          
          <div class="method-source-code" id="destroy-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation/modification_methods.rb, line 67</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">id</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">id</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">one_id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">one_id</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">find</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">destroy</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- destroy-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="ModificationMethods.html#method-i-delete">delete</a>
        </div>
        

        
      </div><!-- destroy-method -->

    
      <div id="method-i-destroy_all" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">destroy_all</span><span
            class="method-args">(conditions = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Destroys the records matching <code>conditions</code> by instantiating each
record and calling its <code>destroy</code> method. Each object’s
callbacks are executed (including <code>:dependent</code> association
options and <code>before_destroy</code>/<code>after_destroy</code> Observer
methods). Returns the collection of objects that were destroyed; each will
be frozen, to reflect that no changes should be made (since they can’t be
persisted).</p>

<p>Note: Instantiation, callback execution, and deletion of each record can be
time consuming when you’re removing many records at once. However, it is
necessary to perform it this way to ensure that the SOLR index stays in
sync with the Cassandra data store.</p>

<p><code>delete_all</code> is aliased to this because you can’t delete
without running the requisite callbacks. (at least not yet)</p>

<h4 id="method-i-destroy_all-label-Parameters">Parameters</h4>
<ul><li>
<p><code>conditions</code> - A string, array, or hash that specifies which
records</p>
</li></ul>

<p>to destroy. If omitted, all records matching the current relation are
destroyed. See the Conditions section in the introduction to <a
href="Base.html">DatastaxRails::Base</a> for more information.</p>

<h4 id="method-i-destroy_all-label-Examples">Examples</h4>

<p>Person.destroy_all(:status =&gt; “inactive”) Person.where(:age =&gt;
0..18).<a
href="ModificationMethods.html#method-i-destroy_all">#destroy_all</a>
Person.where_not(:status =&gt; “active”).<a
href="ModificationMethods.html#method-i-destroy_all">#destroy_all</a></p>
          

          
          <div class="method-source-code" id="destroy_all-source">
            <pre><span class="ruby-comment"># File lib/datastax_rails/relation/modification_methods.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy_all</span>(<span class="ruby-identifier">conditions</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">conditions</span>
    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">destroy_all</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">object</span><span class="ruby-operator">|</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">destroy</span> }.<span class="ruby-identifier">tap</span> { <span class="ruby-identifier">reset</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- destroy_all-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="ModificationMethods.html#method-i-delete_all">delete_all</a>
        </div>
        

        
      </div><!-- destroy_all-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.11.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

